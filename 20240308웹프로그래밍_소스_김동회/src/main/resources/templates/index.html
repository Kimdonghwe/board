<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>초기화면</title>
    </head>
    <body>
        <h3>초기화면</h3>

        <th:block th:if="${session.UserData}">
            <p th:text="${session.UserData.nickname}"></p>
            <ul>
                <li><a href="/post">게시글</a></li>
                <li><a href="#" id="logout">로그아웃</a></li>
            </ul>
        </th:block>

        <th:block th:unless="${session.UserData}">
            <ul>
                <li><a href="/login">로그인</a></li>
                <li><a href="/member/join">회원가입</a></li>
            </ul>
        </th:block>

        <script>
            logout.addEventListener('click', (evt) => {
                evt.preventDefault(); // 기본 이벤트 제거
                fetch('/logout', { method: 'POST', body: null })
                    .then((res) => res.text())
                    .then((res) => {
                        if (res === 'OK') {
                            console.log(res);
                            location.href = '/';
                        }
                    })
                    .catch(console.log);
            });
        </script>
    </body>
</html>
